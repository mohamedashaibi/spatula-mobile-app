{"version":3,"sources":["./src/app/Pages/purchase/purchase-routing.module.ts","./src/app/Pages/purchase/purchase.module.ts","./src/app/Pages/purchase/purchase.page.ts","./src/app/Pages/purchase/purchase.page.scss","./src/app/Pages/purchase/purchase.page.html"],"names":[],"mappings":"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","file":"src_app_Pages_purchase_purchase_module_ts.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { PurchasePage } from './purchase.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: PurchasePage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class PurchasePageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\n\nimport { PurchasePageRoutingModule } from './purchase-routing.module';\n\nimport { PurchasePage } from './purchase.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    PurchasePageRoutingModule\n  ],\n  declarations: [PurchasePage]\n})\nexport class PurchasePageModule {}\n","import { Location } from '@angular/common';\nimport { HttpClient, HttpHeaders, HttpParams } from '@angular/common/http';\nimport { Component, OnInit } from '@angular/core';\nimport { HTTP } from '@ionic-native/http/ngx';\nimport { AlertController } from '@ionic/angular';\nimport { SharedService } from 'src/app/Services/shared.service';\n\n@Component({\n  selector: 'app-purchase',\n  templateUrl: './purchase.page.html',\n  styleUrls: ['./purchase.page.scss'],\n})\nexport class PurchasePage implements OnInit {\n  course;\n  check;\n  verificationCode;\n  phoneNumber = \"\";\n\n  constructor(public shared: SharedService, public location: Location, public http: HTTP, public alertCtrl: AlertController) {\n    this.course = this.shared.selectedCourse;\n  }\n  goBack() {\n    this.location.back();\n  }\n  ngOnInit() {\n  }\n  InitializeTPayPaymentFunc(evt?) {\n    console.log(this.phoneNumber)\n    let headers = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n      }),\n\n      // };\n    }\n    let params = {\n      api_token: this.shared.token,\n      course_id: parseInt(this.course.id),\n      phone: this.phoneNumber\n    }\n\n    console.log(params)\n    const nativeHeaders = {\n      'Content-Type': 'application/json',\n    };\n    return this.http.post(this.shared.base_url + \"initializeTPayPayment\", params, nativeHeaders);\n  }\n  purchase = {\n\n  }\n  purchaseVideo() {\n    if (this.phoneNumber.length != 10 || !this.phoneNumber.startsWith('09')) {\n      this.check = true;\n    }\n    else {\n      this.InitializeTPayPaymentFunc().then(async (res: any) => {\n        console.log(res)\n        let resp = JSON.parse(res.data);\n        if (resp.errorMessage && resp.errorMessage != null && resp.errorMessage != \"\") {\n          if (resp.operationStatusCode == 51)\n            this.shared.showErroToast(\"من فضلك ادخل رقم هاتف صحيح\")\n        }\n        if (resp.transactionId) {\n          this.purchase[\"transactionId\"] = resp.transactionId;\n        }\n        if (this.purchase[\"transactionId\"]) {\n          this.verificationCode = await this.alertCtrl.create({\n            header: \"تأكيد الشراء\",\n            message: \"<p> ادخل رمز تاكيد الشراء المرسل الى الرقم \" + this.phoneNumber + \" مكون من ٦ ارقام </p>\" + '<input placeholder=\"ادخل الكود المرسل اليك والمكون من ٦ ارقام\" id=\"purchaseCode\" /><p id=\"errorCode\"></p>',\n            cssClass: 'vtc-popup',\n            buttons: [\n              {\n                text: '<b>تغيير الرقم</b>',\n                handler: function (e) {\n                  return;\n                }\n              },\n              {\n                text: '<b>اكمال الشراء</b>',\n                handler: (e) => {\n                  e.preventDefault();\n                  if (!document.getElementById('purchaseCode').getAttribute(\"value\")) {\n                    document.getElementById('errorCode').innerHTML = \"رجاء التحقق من الكود المدخل واعادة المحاولة\";\n                    return;\n                  }\n                  this.FinishPaymentFunc().then((res: any) => {\n                    let resp2 = JSON.parse(res.data);\n                    if (resp2.operationStatusCode == 0) {\n                      this.verificationCode.close();\n                      this.alertCtrl.create({\n                        header: \"سباتولا\",\n                        message: \"تمت عملية الشراء بنجاح\",\n                        cssClass: 'vtc-popup',\n                        buttons: [\n                          {\n                            text: '<b>موافق</b>',\n                            handler: (e) => {\n                              this.goBack();\n                              return;\n\n                            }\n                          }\n                        ]\n                      });\n                    }\n                    if (resp2.operationStatusCode == 4) {\n                      document.querySelector('#errorCode').innerHTML = \"لا يوجد رصيد كافي لإتمام الشراء\";\n                    }\n                    else {\n                      document.querySelector('#errorCode').innerHTML = \"رجاء التحقق من الكود المدخل واعادة المحاولة\";\n                    }\n                  });\n\n                  return;\n                }\n              }\n            ]\n          });\n        } else {\n          this.alertCtrl.create({\n            header: \"سباتولا\",\n            message: \"هناك خطأ تقني, رجاء المحاولة لاحقاً\",\n            cssClass: 'vtc-popup',\n            buttons: [\n              {\n                text: '<b>موافق</b>',\n                handler: function (e) {\n                  return;\n                }\n              }\n            ]\n          });\n        }\n      }, async err => {\n        console.log(err)\n        this.shared.showErroAlert();\n      })\n    }\n\n  }\n\n  FinishPaymentFunc() {\n    let headers = {\n      headers: new HttpHeaders({\n        'Content-Type': 'application/x-www-form-urlencoded; charset=UTF-8',\n      }),\n\n      // };\n    }\n    let params = {\n      api_token: this.shared.token,\n      course_id: parseInt(this.course.course_id),\n      pinCode: document.getElementById('purchaseCode').getAttribute(\"value\"),\n      transactionId: this.purchase[\"transactionId\"]\n    }\n    console.log(params)\n    const nativeHeaders = {\n      'Content-Type': 'application/json',\n    };\n    return this.http.post(this.shared.base_url + \"confirmTPayPayment\", params, nativeHeaders);\n  }\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJwdXJjaGFzZS5wYWdlLnNjc3MifQ== */\";","export default \"<ion-header class=\\\"spatula-header\\\">\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button></ion-menu-button>\\n    </ion-buttons>\\n    <ion-title>\\n      <p style=\\\"direction: rtl\\\">عملية شراء</p>\\n    </ion-title>\\n    <ion-buttons slot=\\\"end\\\">\\n      <ion-button (click)=\\\"goBack()\\\">\\n        <ion-icon src=\\\"assets/img/backButton.svg\\\" slot=\\\"icon-only\\\" style=\\\"font-size:16px\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n  <div class=\\\"purchase\\\">\\n    <div class=\\\"purchase-image\\\"></div>\\n    <ul>\\n      <li><label>حول العملية</label>\\n        <p>{{course.name}}</p>\\n      </li>\\n      <li><label>قيمة المبلغ</label>\\n        <p> {{course.price}} دينار ليبي</p>\\n      </li>\\n    </ul>\\n    <div class=\\\"purchase-phone\\\">\\n      <label>* رقم النقال </label>\\n      <ion-input [(ngModel)]=\\\"phoneNumber\\\" maxlength=\\\"10\\\" placeholder=\\\"الرجاء ادخال رقم النقال 09xxxxxxxx\\\" type=\\\"tel\\\" ></ion-input>\\n      <p *ngIf=\\\"(phoneNumber.length !=10 || !phoneNumber.startsWith('09'))  && check\\\">يرجى ادخال رقم\\n        النقال 10 ارقام تبدأ بـ 09 </p>\\n      <button (click)=\\\"purchaseVideo()\\\">شراء</button>\\n    </div>\\n  </div>\\n</ion-content>\\n\\n<div class=\\\"help\\\" (click)=\\\"shared.openLink('whats')\\\">\\n  <img src=\\\"assets/img/whatsapp.png\\\" />\\n  <p>للمساعدة. اضغطي هنا للتواصل عبر الواتساب.</p>\\n</div>\";"],"sourceRoot":"webpack:///"}